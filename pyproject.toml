[build-system]
requires = ["setuptools>=42", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "raw-data-services"
version = "0.1.0"
description = "High-performance package for efficient market data retrieval from Binance"
readme = "README.md"
requires-python = ">=3.11"
license = {text = "Proprietary"}
authors = [
    {name = "Eon Labs"}
]
classifiers = [
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.11"
]
dependencies = [
    "attrs",
    "pyarrow>=19.0.1", # for local cache files in MMAP Array format
    "polars", # resample and aggregate data faster than pandas
    "pandas", # compatbility with existing code
    "numpy", # for numerical operations
    "fsspec", # for downloading remote files and local file hyrarchy matching of remote files
    "requests", # fsspec compatible HTTP client
    "httpx>=0.24.0", # as preferred HTTP client
    "aiohttp", # for HTTP requests
    "tenacity", # for retrying operations
    "colorlog", # for colored logging
    "psutil", # for system monitoring
    "typer", # for CLI
    "rich", # for elegant logging and CLI output
    "pendulum" # for date and time operations
]

[project.optional-dependencies]
dev = [
    "pytest",
    "pytest-asyncio",
    "pytest-cov",
    "pytest-xdist",
    "pytest-profiling",
    "gitpython", # for git operations
    "rope", # for refactoring imports
    "ruff", # for linting and formatting
    "pyright", # for static type checking (latest version)
    "pylint", # Ruff covers many Pylint rules
    "autoflake", # Ruff handles unused imports
    "vulture", # for dead code detection
    "twine", # for uploading to PyPI
    "tomli" # for reading pyproject.toml
]
# Command-line scripts defined here
[project.scripts]
dsm-demo-cli = "examples.sync.dsm_demo_cli:app"
dsm-demo-module = "examples.lib_module.dsm_demo_module:main"
recmove = "scripts.dev.refactor_move:app"

[tool.setuptools]
packages = ["core", "utils", "examples", "utils_for_debug", "scripts"]

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = "test_*.py"
python_functions = "test_*" 

[tool.ruff]
# preview = true # Enable preview rules
lint.select = [
    # "PD",        # pandas-vet: Common pandas pitfalls
    "RET",       # flake8-return: Improper return statements
    "PL",        # Pylint: All Pylint rules - Ruff covers many, but PL includes Pylint-specific ones not fully redundant
    "RUF",       # Ruff-specific rules (idiomatic suggestions) - Essential for Ruff's unique checks
]
lint.ignore = [
    "E501",      # Line too long - Allow longer lines for better readability in some cases
    "PLR0912",   # Too many branches - Allow functions with many branches when necessary
    "PLR0913",   # Too many arguments - Allow functions with many args when necessary
    "PLR0915",   # Too many class variables - Allow class variables when necessary
]
# Align with project.requires-python (>=3.11)
# Ruff comment - this cannot be inherited automatically
target-version = "py311"
# Allow autofix for all enabled rules
lint.fixable = ["ALL"]
# Allow unused variables when underscored
lint.dummy-variable-rgx = "^(_+|(_+[a-zA-Z0-9_]*[a-zA-Z0-9]+?))$"
# Respect .gitignore
respect-gitignore = true
# Exclude directories from Ruff checks
lint.exclude = ["playground/", "tests/", ".git/", "__pycache__/"]

[tool.ruff.lint.isort]
# Note: This cannot automatically inherit from project dependencies.
# Make sure to keep this list in sync with [project] dependencies and [project.optional-dependencies]
known-third-party = ["pandas", "numpy", "polars", "pyarrow", "httpx", "tenacity", "rich", "typer", "pytest", "gitpython", "rope", "pylint", "autoflake", "vulture", "twine"]

[tool.vulture]
# Paths to scan for dead code
paths = ["utils/", "core/", "scripts/"]
# Exclude test-related files
exclude = ["tests/", "*/test_*.py", "*/conftest.py"]
# Minimum confidence threshold (0-100)
min_confidence = 80
# Sort by size to focus on larger unused functions first
sort_by_size = true
# Ignore certain naming patterns that might be used for required interfaces
ignore_names = ["__*__", "setup_*", "teardown_*"]
# Ignore certain decorators that might create false positives
ignore_decorators = ["@app.route", "@property", "@classmethod", "@staticmethod"]